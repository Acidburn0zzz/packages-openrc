# Maintainer: artoo <artoo@manjaro.org>

_udevver=219
_pkgname=elogind

pkgname=elogind-git
pkgver=r19976.b952404
pkgrel=1
pkgdesc="elogind is a strpped down version of systemd"
arch=('i686' 'x86_64')
url="https://github.com/andywingo/elogind"
license=('GPL')
provides=("eudev-systemdcompat=${_udevver}"
		"libsystemd=${_udevver}"
		"systemd=${_udevver}"
		"systemd-tools=${_udevver}"
		'libsystemd.so'
		'libsystemd-daemon.so'
		'libsystemd-journal.so'
		'libsystemd-login.so')
depends=('acl' 'bash' 'dbus' 'glib2' 'iptables' 'kbd' 'kmod' 'hwids' 'libcap'
		'libgcrypt' 'libidn' 'lz4' 'pam' 'libseccomp' 'util-linux' 'xz')
makedepends=('acl' 'cryptsetup' 'docbook-xsl' 'gobject-introspection' 'gperf'
             'gtk-doc' 'intltool' 'kmod' 'libcap' 'libidn' 'libgcrypt' 'libmicrohttpd'
             'libxslt' 'util-linux' 'linux-api-headers' 'lz4' 'pam' 'python'
             'python-lxml' 'quota-tools' 'shadow' 'xz' 'git')
conflicts=('systemd'
		'systemd-tools'
		'libsystemd'
		'eudev-systemdcompat')
source=("${_pkgname}::git+$url.git")
sha256sums=('SKIP')

pkgver() {
	cd "${_pkgname}"
	printf "r%s.%s" "$(git rev-list --count HEAD)" "$(git rev-parse --short HEAD)"
}

build(){


	cd "${_pkgname}"
	#ln -s "$srcdir/${_pkgname}" "$srcdir/${pkgname}"

	./autogen.sh
	./configure --prefix=/usr \
		--sysconfdir=/etc \
		--enable-introspection \
		--libdir=/usr/lib \
		--with_rootprefix=/usr \
		--datarootdir=/usr/share \
		--enable_split_usr \
		--enable-gtk-doc
  make

}

package() {
	cd "${_pkgname}"
	make DESTDIR="$pkgdir" install
}
