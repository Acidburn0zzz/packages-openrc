# Maintainer: udeved <udeved@openrc4arch.site40.net>

_dev="~titanofold"
_gentoo_uri="http://dev.gentoo.org/${_dev}"
_name=postgresql
_ver=2.5

pkgname=${_name}-openrc
pkgver=20130821
pkgrel=1
pkgdesc="OpenRC ${_name} init script"
arch=('any')
url="http://openrc4arch.site40.net"
license=('GPL2')
depends=('openrc' "${_name}")
groups=('openrc-db')
install=${_name}.install
source=("http://dev.gentoo.org/~titanofold/${_name}-initscript-${_ver}.tbz2")

pkgver() {
  date +%Y%m%d
}

package() {
  install -Dm755 "${srcdir}/postgresql.confd" "${pkgdir}/etc/conf.d/postgresql"
  install -Dm755 "${srcdir}/postgresql.init" "${pkgdir}/etc/init.d/postgresql"
  sed -e 's|/var/lib/postgresql/@SLOT@/data|/var/lib/postgres/data|' -e 's|/etc/postgresql-@SLOT@/|/var/lib/postgres/data|' -i "${pkgdir}/etc/conf.d/postgresql"
  sed -e 's|#!/sbin/runscript|#!/usr/bin/runscript|' -e 's|/usr/lib/postgresql-@SLOT@/bin/pg_ctl|/usr/bin/pg_ctl|' -e 's|/usr/lib/postgresql-@SLOT@/bin/postgres|/usr/bin/postgres|' -i "${pkgdir}/etc/init.d/postgresql"
}

sha256sums=('723b2564572722171e097b165a72453b788cb4451638677dcc5f853cbd2d3c09')
