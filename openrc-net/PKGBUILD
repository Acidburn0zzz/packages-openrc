# Maintainer: udeved <udeved@openrc4arch.site40.net>

pkgbase=openrc-net
pkgname=openrc-net
true && pkgname=('apache-openrc' 'avahi-openrc' 'bind-openrc'
		'bitlbee-openrc' 'bluez-openrc' 'connman-openrc'
		'cups-openrc' 'cyrus-sasl-openrc' 'dhcp-openrc'
		'dhcpcd-openrc' 'hostapd-openrc' 'inetutils-openrc'
		'iptables-openrc' 'krb5-openrc' 'lighttpd-openrc'
		'nfs-utils-openrc' 'ntp-openrc' 'openldap-openrc'
		'openslp-openrc' 'openssh-openrc' 'polipo-openrc'
		'postfix-openrc' 'privoxy-openrc' 'quota-tools-openrc'
		'rpcbind-openrc' 'rsync-openrc' 'samba-openrc'
		'squid-openrc' 'transmission-openrc' 'ufw-openrc'
		'vsftpd-openrc' 'wicd-openrc' 'wpa_supplicant-openrc'
		'xinetd-openrc'	'ypbind-mt-openrc' 'ypserv-openrc')
pkgver=20131016
pkgrel=1
pkgdesc="OpenRC init scripts"
arch=('any')
url="http://openrc4arch.site40.net"
license=('GPL2')
groups=('openrc-net')
makedepends=('apache' 'avahi' 'bind' 'bitlbee' 'bluez' 'connman' 'cups' 'cyrus-sasl'
	    'dbus-openrc' 'device-mapper-openrc' 'dhcp' 'dhcpcd' 'hostapd'
	    'inetutils' 'iptables' 'krb5' 'lighttpd' 'nfs-utils' 'ntp' 'openldap'
	    'openslp' 'openssh' 'polipo' 'postfix' 'privoxy' 'quota-tools' 'rpcbind'
	    'rsync' 'samba' 'squid' 'transmission' 'ufw' 'vsftpd' 'wicd' 'wpa_supplicant'
	    'xinetd' 'ypbind-mt' 'ypserv')
conflicts=('openrc-arch-services-git')

_apver=2.4.4
_aprel=20130801
_avaver=0.6.31
_gentoo_uri="http://sources.gentoo.org/cgi-bin/viewvc.cgi/gentoo-x86"
_dev_uri="http://dev.gentoo.org/~kensington/dist/apache"

source=("${_dev_uri}/gentoo-apache-${_apver}-${_aprel}.tar.bz2"
	"http://avahi.org/download/avahi-${_avaver}.tar.gz"
	"${_gentoo_uri}/net-dns/bind/files/named.confd-r6"
	"${_gentoo_uri}/net-dns/bind/files/named.init-r12"
	"${_gentoo_uri}/net-im/bitlbee/files/bitlbee.confd"
	"${_gentoo_uri}/net-im/bitlbee/files/bitlbee.initd"
	"${_gentoo_uri}/net-wireless/bluez/files/rfcomm-conf.d"
	"${_gentoo_uri}/net-wireless/bluez/files/rfcomm-init.d"
	"${_gentoo_uri}/net-wireless/bluez/files/bluetooth-init.d-r2"
	"${_gentoo_uri}/net-misc/connman/files/connman.confd"
	"${_gentoo_uri}/net-misc/connman/files/connman.initd2"
	"${_gentoo_uri}/net-print/cups/files/cupsd.init.d-r1"
	"${_gentoo_uri}/dev-libs/cyrus-sasl/files/saslauthd2.rc7"
	"${_gentoo_uri}/net-misc/dhcp/files/dhcpd.conf2"
	"${_gentoo_uri}/net-misc/dhcp/files/dhcpd.init5"
	"${_gentoo_uri}/net-misc/dhcp/files/dhcrelay.conf"
	"${_gentoo_uri}/net-misc/dhcp/files/dhcrelay6.conf"
	"${_gentoo_uri}/net-misc/dhcp/files/dhcrelay.init3"
	"${_gentoo_uri}/net-misc/dhcpcd/files/dhcpcd.initd"
	"${_gentoo_uri}/net-wireless/hostapd/files/hostapd-conf.d"
	"${_gentoo_uri}/net-wireless/hostapd/files/hostapd-init.d"
	'inetutils.confd'
	'inetutils.initd'
	"${_gentoo_uri}/net-firewall/iptables/files/iptables-1.4.13.confd"
	"${_gentoo_uri}/net-firewall/iptables/files/ip6tables-1.4.13.confd"
	"${_gentoo_uri}/net-firewall/iptables/files/iptables-1.4.13-r1.init"
	"${_gentoo_uri}/app-crypt/mit-krb5/files/mit-krb5kadmind.initd-r1"
	"${_gentoo_uri}/app-crypt/mit-krb5/files/mit-krb5kdc.initd-r1"
	"${_gentoo_uri}/app-crypt/mit-krb5/files/mit-krb5kdc.initd-r1"
	"${_gentoo_uri}/www-servers/lighttpd/files/lighttpd.confd"
	"${_gentoo_uri}/www-servers/lighttpd/files/lighttpd.initd"
	"${_gentoo_uri}/net-fs/nfs-utils/files/nfs.confd"
	"${_gentoo_uri}/net-fs/nfs-utils/files/nfs.initd"
	"${_gentoo_uri}/net-fs/nfs-utils/files/nfsmount.initd"
	"${_gentoo_uri}/net-fs/nfs-utils/files/rpc.gssd.initd"
	"${_gentoo_uri}/net-fs/nfs-utils/files/rpc.idmapd.initd"
	"${_gentoo_uri}/net-fs/nfs-utils/files/rpc.pipefs.initd"
	"${_gentoo_uri}/net-fs/nfs-utils/files/rpc.statd.initd"
	"${_gentoo_uri}/net-fs/nfs-utils/files/rpc.svcgssd.initd"
	"${_gentoo_uri}/net-misc/ntp/files/ntpd.confd"
	"${_gentoo_uri}/net-misc/ntp/files/ntpd.rc"
	"${_gentoo_uri}/net-misc/ntp/files/ntp-client.confd"
	"${_gentoo_uri}/net-misc/ntp/files/ntp-client.rc"
	"${_gentoo_uri}/net-misc/ntp/files/sntp.rc"
	"${_gentoo_uri}/net-misc/ntp/files/sntp.confd"
	"${_gentoo_uri}/net-nds/openldap/files/slapd-confd-2.4.28-r1"
	"${_gentoo_uri}/net-nds/openldap/files/slapd-initd-2.4.28-r1"
	"${_gentoo_uri}/net-libs/openslp/files/slpd-init"
	"${_gentoo_uri}/net-misc/openssh/files/sshd.confd"
	"${_gentoo_uri}/net-misc/openssh/files/sshd.rc6.4"
	"${_gentoo_uri}/net-proxy/polipo/files/polipo.initd"
	"${_gentoo_uri}/mail-mta/postfix/files/postfix.rc6.2.7"
	"${_gentoo_uri}/net-proxy/privoxy/files/privoxy.initd"
	"${_gentoo_uri}/sys-fs/quota/files/quota.confd"
	"${_gentoo_uri}/sys-fs/quota/files/quota.rc7"
	"${_gentoo_uri}/sys-fs/quota/files/rpc.rquotad.initd"
	"${_gentoo_uri}/net-nds/rpcbind/files/rpcbind.confd"
	"${_gentoo_uri}/net-nds/rpcbind/files/rpcbind.initd"
	"${_gentoo_uri}/net-misc/rsync/files/rsyncd.conf.d"
	"${_gentoo_uri}/net-misc/rsync/files/rsyncd.init.d-r1"
	"${_gentoo_uri}/net-fs/samba/files/4.0/samba4.confd"
	"${_gentoo_uri}/net-fs/samba/files/4.0/samba4.initd-r1"
	"${_gentoo_uri}/net-proxy/squid/files/squid.confd-r1"
	"${_gentoo_uri}/net-proxy/squid/files/squid.initd-r3"
	"${_gentoo_uri}/net-p2p/transmission/files/transmission-daemon.confd.4"
	"${_gentoo_uri}/net-p2p/transmission/files/transmission-daemon.initd.9"
	"${_gentoo_uri}/net-firewall/ufw/files/ufw.confd"
	"${_gentoo_uri}/net-firewall/ufw/files/ufw-2.initd"
	"${_gentoo_uri}/net-ftp/vsftpd/files/vsftpd.init"
	"${_gentoo_uri}/net-ftp/vsftpd/files/vsftpd-checkconfig.sh"
	"${_gentoo_uri}/net-misc/wicd/files/wicd-init.d"
	"${_gentoo_uri}/net-wireless/wpa_supplicant/files/wpa_supplicant-conf.d"
	"${_gentoo_uri}/net-wireless/wpa_supplicant/files/wpa_supplicant-init.d"
	"${_gentoo_uri}/sys-apps/xinetd/files/xinetd.confd"
	"${_gentoo_uri}/sys-apps/xinetd/files/xinetd.rc6"
	"${_gentoo_uri}/net-nds/ypbind/files/ypbind.confd-r1"
	"${_gentoo_uri}/net-nds/ypbind/files/ypbind.initd"
	"${_gentoo_uri}/net-nds/ypserv/files/rpc.yppasswdd.confd"
	"${_gentoo_uri}/net-nds/ypserv/files/rpc.yppasswdd-r1"
	"${_gentoo_uri}/net-nds/ypserv/files/rpc.ypxfrd.confd"
	"${_gentoo_uri}/net-nds/ypserv/files/rpc.ypxfrd-2.23"
	"${_gentoo_uri}/net-nds/ypserv/files/ypserv.confd"
	"${_gentoo_uri}/net-nds/ypserv/files/ypserv")



pkgver() {
  date +%Y%m%d
}

_shebang='s|#!/sbin/runscript|#!/usr/bin/runscript|'
_runpath='s|/var/run|/run|g'
_binpath='s|/usr/sbin|/usr/bin|g'
_binpath2='s|/sbin|/usr/bin|g'

package_apache-openrc() {
	true
	pkgdesc="OpenRC apache init script"
	depends=('openrc-base' 'apache')
	install=apache.install

	install -Dm755 "${srcdir}/gentoo-apache-${_apver}/init/apache2.confd" "${pkgdir}/etc/conf.d/httpd"
	install -Dm755 "${srcdir}/gentoo-apache-${_apver}/init/apache2.initd" "${pkgdir}/etc/init.d/httpd"

	local _p1='s|apache2|httpd|g' _p2='s|/etc/httpd/httpd.conf|/etc/httpd/conf/httpd.conf|g'
	sed -e "${_shebang}" -e "${_binpath}" -e "${_p1}" -e "${_p2}" -i "${pkgdir}/etc/init.d/httpd"
}

package_avahi-openrc() {
	true
	pkgdesc="OpenRC avahi init script"
	depends=('openrc-base' 'avahi' 'dbus-openrc')
	install=avahi.install

	install -Dm755 "${srcdir}/avahi-${_avaver}/initscript/gentoo/avahi-daemon.in" "${pkgdir}/etc/init.d/avahi-daemon"
	install -Dm755 "${srcdir}/avahi-${_avaver}/initscript/gentoo/avahi-dnsconfd.in" "${pkgdir}/etc/init.d/avahi-dnsconfd"

	local _p1='s/opts/extra_started_commands/' _p2='s|@sbindir@|/usr/bin|'
	for f in ${pkgdir}/etc/init.d/*;do
	  sed -e "${_shebang}" -e "${_p1}" -e "${_p2}" -i $f
	done
}

package_bind-openrc() {
	true
	pkgdesc="OpenRC bind init script"
	depends=('openrc-base' 'bind')
	install=bind.install

	install -Dm755 "${srcdir}/named.confd-r6" "${pkgdir}/etc/conf.d/named"
	install -Dm755 "${srcdir}/named.init-r12" "${pkgdir}/etc/init.d/named"

	local _p1='s|/etc/bind/named.conf|/etc/named.conf|g'
	sed -e "${_shebang}" -e "${_binpath}" -e "${_runpath}" -e "${_p1}" -i "${pkgdir}/etc/init.d/named"
}

package_bitlbee-openrc() {
	true
	pkgdesc="OpenRC bitlbee init script"
	depends=('openrc-base' 'bitlbee')
	install=bitlbee.install

	install -Dm755 "${srcdir}/bitlbee.confd" "${pkgdir}/etc/conf.d/bitlbee"
	install -Dm755 "${srcdir}/bitlbee.initd" "${pkgdir}/etc/init.d/bitlbee"

	sed -e "${_shebang}" -e "${_binpath}" -e "${_runpath}" -i "${pkgdir}/etc/init.d/bitlbee"
}

package_bluez-openrc() {
	true
	pkgdesc="OpenRC bluez init script"
	depends=('openrc-base' 'bluez' 'dbus-openrc')
	install=bluez.install

	install -Dm755 "${srcdir}/rfcomm-conf.d" "${pkgdir}/etc/conf.d/rfcomm"
	install -Dm755 "${srcdir}/rfcomm-init.d" "${pkgdir}/etc/init.d/rfcomm"
	install -Dm755 "${srcdir}/bluetooth-init.d-r2" "${pkgdir}/etc/init.d/bluetooth"

	for f in ${pkgdir}/etc/init.d/*;do
	  sed -e "${_shebang}" -e "${_binpath}" -i $f
	done
}

package_connman-openrc() {
	true
	pkgdesc="OpenRC connman init script"
	depends=('openrc-base' 'connman')
	install=connman.install

	install -Dm755 "${srcdir}/connman.confd" "${pkgdir}/etc/conf.d/connman"
	install -Dm755 "${srcdir}/connman.initd2" "${pkgdir}/etc/init.d/connman"

	sed -e "${_shebang}" -e "${_binpath}" -i "${pkgdir}/etc/init.d/connman"
}

package_cups-openrc() {
	true
	pkgdesc="OpenRC cups init script"
	depends=('openrc-base' 'cups' 'dbus-openrc')
	optdepends=('avahi-openrc')
	install=cups.install

	install -Dm755 "${srcdir}/cupsd.init.d-r1" "${pkgdir}/etc/init.d/cupsd"

	local _p1='s|lp:lpadmin|daemon:sys|' _p2='s|@neededservices@|need dbus avahi-daemon|'
	sed -e "${_shebang}" -e "${_binpath}" -e "${_p1}" -e "${_p1}" -i "${pkgdir}/etc/init.d/cupsd"
}

package_cyrus-sasl-openrc() {
	true
	pkgdesc="OpenRC cyrus-sasl init script"
	depends=('openrc-base' 'cyrus-sasl')
	install=cyrus-sasl.install

	install -Dm755 "${srcdir}/saslauthd2.rc7" "${pkgdir}/etc/init.d/saslauthd"

	sed -e "${_shebang}" -e "${_binpath}" -i "${pkgdir}/etc/init.d/saslauthd"

}

package_dhcp-openrc() {
	true
	pkgdesc="OpenRC dhcp init script"
	depends=('openrc-base' 'dhcp')
	optdepends=('openldap-openrc' 'bind-openrc')
	install=dhcp.install

	install -Dm755 "${srcdir}/dhcpd.conf2" "${pkgdir}/etc/conf.d/dhcpd"
	install -Dm755 "${srcdir}/dhcpd.init5" "${pkgdir}/etc/init.d/dhcpd"
	install -Dm755 "${srcdir}/dhcrelay.conf" "${pkgdir}/etc/conf.d/dhcrelay"
	install -Dm755 "${srcdir}/dhcrelay.init3" "${pkgdir}/etc/init.d/dhcrelay"
	install -Dm755 "${srcdir}/dhcrelay6.conf" "${pkgdir}/etc/conf.d/dhcrelay6"
	install -Dm755 "${srcdir}/dhcrelay.init3" "${pkgdir}/etc/init.d/dhcrelay6"

	local _p1='s|#@slapd@|ldap slapd|'
	for f in ${pkgdir}/etc/init.d/*;do
	  sed -e "${_shebang}" -e "${_binpath}" -e "${_runpath}"  -e "${_p1}" -i $f
	done
}

package_dhcpcd-openrc() {
	true
	pkgdesc="OpenRC dhcpcd init script"
	depends=('openrc-base' 'dhcpcd')
	install=dhcpcd.install

	install -Dm755 "${srcdir}/dhcpcd.initd" "${pkgdir}/etc/init.d/dhcpcd"

	sed -e "${_shebang}" -e "${_binpath2}" -e "${_runpath}" -i "${pkgdir}/etc/init.d/dhcpcd"
}

package_hostapd-openrc() {
	true
	pkgdesc="OpenRC hostapd init script"
	depends=('openrc-base' 'hostapd')
	install=hostapd.install

	install -Dm755 "${srcdir}/hostapd-conf.d" "${pkgdir}/etc/conf.d/hostapd"
	install -Dm755 "${srcdir}/hostapd-init.d" "${pkgdir}/etc/init.d/hostapd"

	sed -e "${_shebang}" -e "${_binpath}" -e "${_runpath}" -i "${pkgdir}/etc/init.d/hostapd"
}

package_inetutils-openrc() {
	true
	pkgdesc="OpenRC ftpd init script"
	depends=('openrc-base' 'inetutils')
	install=inetutils.install

	install -Dm755 "${srcdir}/inetutils.confd" "${pkgdir}/etc/init.d/ftpd"
	install -Dm755 "${srcdir}/inetutils.initd" "${pkgdir}/etc/init.d/ftpd"

	sed -e "${_shebang}" -e "${_binpath2}" -i "${pkgdir}/etc/init.d/ftpd"
}

package_iptables-openrc() {
	true
	pkgdesc="OpenRC iptables init script"
	depends=('openrc-base' 'iptables')
	install=iptables.install

	install -Dm755 "${srcdir}/iptables-1.4.13.confd" "${pkgdir}/etc/conf.d/iptables"
	install -Dm755 "${srcdir}/iptables-1.4.13-r1.init" "${pkgdir}/etc/init.d/iptables"
	install -Dm755 "${srcdir}/ip6tables-1.4.13.confd" "${pkgdir}/etc/conf.d/ip6tables"
	install -Dm755 "${srcdir}/iptables-1.4.13-r1.init" "${pkgdir}/etc/init.d/ip6tables"

	for f in ${pkgdir}/etc/init.d/*;do
	  sed -e "${_shebang}" -e "${_binpath2}" -e "${_runpath}" -i $f
	done
}

package_krb5-openrc() {
	true
	pkgdesc="OpenRC krb5 init script"
	depends=('openrc-base' 'krb5')
	install=krb5.install

	install -Dm755 "${srcdir}/mit-krb5kadmind.initd-r1" "${pkgdir}/etc/init.d/krb5kadmind"
	install -Dm755 "${srcdir}/mit-krb5kdc.initd-r1" "${pkgdir}/etc/init.d/krb5kdc"
	install -Dm755 "${srcdir}/mit-krb5kdc.initd-r1" "${pkgdir}/etc/init.d/krb5kpropd"

	local _p1='s|mit-krb5kdc|krb5kdc|g' _p2='s|mit-krb5kdc mit-krb5kadmind|krb5kdc krb5kadmind|g'
	for f in ${pkgdir}/etc/init.d/*;do
	  sed -e "${_shebang}" -e "${_binpath}" -e "${_runpath}" -e "${_p1}" -e "${_p2}" -i $f
	done
}

package_lighttpd-openrc() {
	true
	pkgdesc="OpenRC lighttpd init script"
	depends=('openrc-base' 'lighttpd')
	install=lighttpd.install

	install -Dm755 "${srcdir}/lighttpd.confd" "${pkgdir}/etc/conf.d/lighttpd"
	install -Dm755 "${srcdir}/lighttpd.initd" "${pkgdir}/etc/init.d/lighttpd"

	sed -e "${_shebang}" -e "${_binpath}" -e "${_runpath}" -i "${pkgdir}/etc/init.d/lighttpd"
}

package_rpcbind-openrc() {
	true
	pkgdesc="OpenRC rpcbind init script"
	depends=('openrc-base' 'rpcbind')
	install=rpcbind.install

	install -Dm755 "${srcdir}/rpcbind.confd" "${pkgdir}/etc/conf.d/rpcbind"
	install -Dm755 "${srcdir}/rpcbind.initd" "${pkgdir}/etc/init.d/rpcbind"

	sed -e "${_shebang}" -e "${_binpath2}" -e "${_runpath}" -i "${pkgdir}/etc/init.d/rpcbind"
}

package_nfs-utils-openrc() {
	true
	pkgdesc="OpenRC nfs-utils init script"
	depends=('openrc-base' 'nfs-utils' 'rpcbind-openrc' 'device-mapper-openrc')
	optdepends=('ypbind-openrc' 'quota-tools-openrc' 'bind-openrc')
	install=nfs-utils.install

	install -Dm755 "${srcdir}/nfs.confd" "${pkgdir}/etc/conf.d/nfs-rc"
	install -Dm755 "${srcdir}/nfs.initd" "${pkgdir}/etc/init.d/nfs"
	install -Dm755 "${srcdir}/nfsmount.initd" "${pkgdir}/etc/init.d/nfsmount"
	install -Dm755 "${srcdir}/rpc.gssd.initd" "${pkgdir}/etc/init.d/rpc.gssd"
	install -Dm755 "${srcdir}/rpc.idmapd.initd" "${pkgdir}/etc/init.d/rpc.idmapd"
	install -Dm755 "${srcdir}/rpc.pipefs.initd" "${pkgdir}/etc/init.d/rpc.pipefs"
	install -Dm755 "${srcdir}/rpc.statd.initd" "${pkgdir}/etc/init.d/rpc.statd"
	install -Dm755 "${srcdir}/rpc.svcgssd.initd" "${pkgdir}/etc/init.d/rpc.svcgssd"

	local _p1='s|/etc/conf.d/nfs|/etc/conf.d/nfs-rc|g'

	for f in ${pkgdir}/etc/init.d/*;do
	  sed -e "${_shebang}" -e "${_binpath}" -e "${_runpath}"  -e "${_p1}" -i $f
	done
}

package_ntp-openrc() {
	true
	pkgdesc="OpenRC ntp init script"
	depends=('openrc-base' 'ntp')
	optdepends=('bind-openrc')
	provides=('openrc-timed')
	conflicts=('openrc-timed')
	install=ntp.install

	install -Dm755 "${srcdir}/ntpd.confd" "${pkgdir}/etc/conf.d/ntpd"
	install -Dm755 "${srcdir}/ntpd.rc" "${pkgdir}/etc/init.d/ntpd"
	install -Dm755 "${srcdir}/ntp-client.confd" "${pkgdir}/etc/conf.d/ntp-client"
	install -Dm755 "${srcdir}/ntp-client.rc" "${pkgdir}/etc/init.d/ntp-client"
	install -Dm755 "${srcdir}/sntp.confd" "${pkgdir}/etc/conf.d/sntp"
	install -Dm755 "${srcdir}/sntp.rc" "${pkgdir}/etc/init.d/sntp"

	for f in ${pkgdir}/etc/init.d/*;do
	  sed -e "${_shebang}" -e "${_binpath}" -e "${_runpath}" -i $f
	done
}

package_openldap-openrc() {
	true
	pkgdesc="OpenRC openldap init script"
	depends=('openrc-base' 'openldap')
	install=openldap.install

	install -Dm755 "${srcdir}/slapd-confd-2.4.28-r1" "${pkgdir}/etc/conf.d/slapd"
	install -Dm755 "${srcdir}/slapd-initd-2.4.28-r1" "${pkgdir}/etc/init.d/slapd"

	local _p1='s|/usr/lib/openldap/slapd|/usr/lib/slapd|g'
	sed -e "${_shebang}" -e "${_binpath}" -e "${_runpath}" -e "${_p1}" -i "${pkgdir}/etc/init.d/slapd"
}

package_openslp-openrc() {
	true
	pkgdesc="OpenRC openslp init script"
	depends=('openrc-base' 'openslp')
	install=openslp.install

	install -Dm755 "${srcdir}/slpd-init" "${pkgdir}/etc/init.d/slpd"

	sed -e "${_shebang}" -e "${_binpath}" -e "${_runpath}" -i "${pkgdir}/etc/init.d/slpd"
}

package_openssh-openrc() {
	true
	pkgdesc="OpenRC openssh init script"
	depends=('openrc-base' 'openssh')
	optdepends=('bind-openrc')
	install=openssh.install

	install -Dm755 "${srcdir}/sshd.confd" "${pkgdir}/etc/conf.d/sshd"
	install -Dm755 "${srcdir}/sshd.rc6.4" "${pkgdir}/etc/init.d/sshd"

	sed -e "${_binpath}" -e "${_runpath}" -i "${pkgdir}/etc/conf.d/sshd"
	sed -e "${_shebang}" -e "${_binpath}" -e "${_runpath}" -i "${pkgdir}/etc/init.d/sshd"
}

package_polipo-openrc() {
	true
	pkgdesc="OpenRC polipo init script"
	depends=('openrc-base' 'polipo')
	install=polipo.install

	install -Dm755 "${srcdir}/polipo.initd" "${pkgdir}/etc/init.d/polipo"

	sed -e "${_shebang}" -e "${_binpath}" -e "${_runpath}" -i "${pkgdir}/etc/init.d/polipo"
}

package_postfix-openrc() {
	true
	pkgdesc="OpenRC postfix init script"
	depends=('openrc-base' 'postfix')
	optdepends=('bind-openrc' 'ypbind-openrc' 'cyrus-sasl-openrc')
	install=postfix.install

	install -Dm755 "${srcdir}/postfix.rc6.2.7" "${pkgdir}/etc/init.d/postfix"

	sed -e "${_shebang}" -e "${_binpath}" -e "${_runpath}" -i "${pkgdir}/etc/init.d/postfix"
}

package_privoxy-openrc() {
	true
	pkgdesc="OpenRC privoxy init script"
	depends=('openrc-base' 'privoxy')
	install=privoxy.install

	install -Dm755 "${srcdir}/privoxy.initd" "${pkgdir}/etc/init.d/privoxy"

	sed -e "${_shebang}" -e "${_binpath}" -e "${_runpath}" -i "${pkgdir}/etc/init.d/privoxy"
}

package_quota-tools-openrc() {
	true
	pkgdesc="OpenRC quota-tools init script"
	depends=('openrc-base' 'quota-tools' 'rpcbind-openrc')
	optdepends=('ypbind-openrc')
	install=quota-tools.install

	install -Dm755 "${srcdir}/quota.confd" "${pkgdir}/etc/conf.d/quota"
	install -Dm755 "${srcdir}/quota.rc7" "${pkgdir}/etc/init.d/quota"
	install -Dm755 "${srcdir}/rpc.rquotad.initd" "${pkgdir}/etc/init.d/rpc.rquotad"

	for f in ${pkgdir}/etc/init.d/*;do
	  sed -e "${_shebang}" -e "${_binpath}" -e "${_runpath}" -i $f
	done
}

package_rsync-openrc() {
	true
	pkgdesc="OpenRC rsync init script"
	depends=('openrc-base' 'rsync')
	install=rsync.install

	install -Dm755 "${srcdir}/rsyncd.conf.d" "${pkgdir}/etc/conf.d/rsyncd"
	install -Dm755 "${srcdir}/rsyncd.init.d-r1" "${pkgdir}/etc/init.d/rsyncd"

	sed -e "${_shebang}" -e "${_binpath}" -e "${_runpath}" -i "${pkgdir}/etc/init.d/rsyncd"
}

package_samba-openrc() {
	true
	pkgdesc="OpenRC samba init script"
	depends=('openrc-base' 'samba')
	install=samba.install

	install -Dm755 "${srcdir}/samba4.confd" "${pkgdir}/etc/conf.d/samba-rc"
	install -Dm755 "${srcdir}/samba4.initd-r1" "${pkgdir}/etc/init.d/samba-rc"

	local _p1='s|SVCNAME##samba|SVCNAME##samba-rc|g' _p2='s|"samba"|"samba-rc"|g'
	sed -e "${_binpath}" -i "${pkgdir}/etc/conf.d/samba-rc"
	sed -e "${_shebang}" -e "${_binpath}" -e "${_runpath}" -e "${_p1}" -e "${_p2}" -i "${pkgdir}/etc/init.d/samba-rc"
}

package_squid-openrc() {
	true
	pkgdesc="OpenRC squid init script"
	depends=('openrc-base' 'squid')
	optdepends=('bind-openrc')
	install=squid.install

	install -Dm755 "${srcdir}/squid.confd-r1" "${pkgdir}/etc/conf.d/squid"
	install -Dm755 "${srcdir}/squid.initd-r3" "${pkgdir}/etc/init.d/squid"

	local _p1='s|chown squid|chown proxy|g'
	sed -e "${_shebang}" -e "${_binpath}" -e "${_runpath}" -e "${_p1}" -i "${pkgdir}/etc/init.d/squid"
}

package_transmission-openrc() {
	true
	pkgdesc="OpenRC transmission init script"
	depends=('openrc-base' 'transmission')
	install=transmission.install

	install -Dm755 "${srcdir}/transmission-daemon.confd.4" "${pkgdir}/etc/conf.d/transmission-daemon"
	install -Dm755 "${srcdir}/transmission-daemon.initd.9" "${pkgdir}/etc/init.d/transmission-daemon"

	sed -e "${_shebang}" -e "${_runpath}" -i "${pkgdir}/etc/init.d/transmission-daemon"
}

package_ufw-openrc() {
	true
	pkgdesc="OpenRC ufw init script"
	depends=('openrc-base' 'ufw')
	install=ufw.install

	install -Dm755 "${srcdir}/ufw.confd" "${pkgdir}/etc/conf.d/ufw"
	install -Dm755 "${srcdir}/ufw-2.initd" "${pkgdir}/etc/init.d/ufw"

	local _p1='s|/usr/share/ufw/ufw-init-functions|/usr/lib/ufw/ufw-init-functions|g'
	sed -e "${_shebang}" -e "${_binpath}" -e "${_runpath}" -e "${_p1}" -i "${pkgdir}/etc/init.d/ufw"
}

package_vsftpd-openrc() {
	true
	pkgdesc="OpenRC vsftpd init script"
	depends=('openrc-base' 'vsftpd')
	optdepends=('bind-openrc')
	install=vsftpd.install

	install -Dm755 "${srcdir}/vsftpd.init" "${pkgdir}/etc/init.d/vsftpd"
	install -Dm755 "${srcdir}/vsftpd-checkconfig.sh" "${pkgdir}/usr/lib/vsftpd-checkconfig.sh"

	local _p1='s|/usr/libexec/|/usr/lib/|g' _p2='s|/etc/vsftpd/|/etc/|g'
	sed -e "${_shebang}" -e "${_binpath}" -e "${_runpath}" -e "${_p1}" -e "${_p2}" -i "${pkgdir}/etc/init.d/vsftpd"
	sed -e "${_p2}" -i "${pkgdir}/usr/lib/vsftpd-checkconfig.sh"
}

package_wpa_supplicant-openrc() {
	true
	pkgdesc="OpenRC wpa_supplicant init script"
	depends=('openrc-base' 'wpa_supplicant')
	install=wpa_supplicant.install

	install -Dm755 "${srcdir}/wpa_supplicant-conf.d" "${pkgdir}/etc/conf.d/wpa_supplicant"
	install -Dm755 "${srcdir}/wpa_supplicant-init.d" "${pkgdir}/etc/init.d/wpa_supplicant"

	sed -e "${_shebang}" -e "${_binpath}" -e "${_runpath}" -i "${pkgdir}/etc/init.d/wpa_supplicant"
}

package_wicd-openrc() {
	true
	pkgdesc="OpenRC wicd init script"
	depends=('openrc-base' 'wicd')
	install=wicd.install

	install -Dm755 "${srcdir}/wicd-init.d" "${pkgdir}/etc/init.d/wicd"

	sed -e "${_shebang}" -e "${_binpath}" -e "${_runpath}" -i "${pkgdir}/etc/init.d/wicd"
}

package_xinetd-openrc() {
	true
	pkgdesc="OpenRC xinetd init script"
	depends=('openrc-base' 'xinetd')
	install=xinetd.install

	install -Dm755 "${srcdir}/xinetd.confd" "${pkgdir}/etc/conf.d/xinetd"
	install -Dm755 "${srcdir}/xinetd.rc6" "${pkgdir}/etc/init.d/xinetd"

	sed -e "${_shebang}" -e "${_binpath}" -e "${_runpath}" -i "${pkgdir}/etc/init.d/xinetd"
}

package_ypbind-mt-openrc() {
	true
	pkgdesc="OpenRC ypbind-mt init script"
	depends=('openrc-base' 'ypbind-mt' 'rpcbind-openrc')
	optdepends=('ypserv-openrc')
	install=ypbind-mt.install

	install -Dm755 "${srcdir}/ypbind.confd-r1" "${pkgdir}/etc/conf.d/ypbind"
	install -Dm755 "${srcdir}/ypbind.initd" "${pkgdir}/etc/init.d/ypbind"

	sed -e "${_shebang}" -e "${_binpath}" -e "${_runpath}" -i "${pkgdir}/etc/init.d/ypbind"
}

package_ypserv-openrc() {
	true
	pkgdesc="OpenRC ypserv init script"
	depends=('openrc-base' 'ypserv')
	install=ypserv.install

	install -Dm755 "${srcdir}/rpc.yppasswdd.confd" "${pkgdir}/etc/conf.d/rpc.yppasswdd"
	install -Dm755 "${srcdir}/rpc.yppasswdd-r1" "${pkgdir}/etc/init.d/rpc.yppasswdd"
	install -Dm755 "${srcdir}/rpc.ypxfrd.confd" "${pkgdir}/etc/conf.d/rpc.ypxfrd"
	install -Dm755 "${srcdir}/rpc.ypxfrd-2.23" "${pkgdir}/etc/init.d/rpc.ypxfrd"
	install -Dm755 "${srcdir}/ypserv.confd" "${pkgdir}/etc/conf.d/ypserv.confd"
	install -Dm755 "${srcdir}/ypserv" "${pkgdir}/etc/init.d/ypserv"

	for f in ${pkgdir}/etc/init.d/*;do
	  sed -e "${_shebang}" -e "${_binpath}" -e "${_runpath}" -i $f
	done
}
